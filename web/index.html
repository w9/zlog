<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>zlog - NDJSON stream viewer</title>
    <link rel="stylesheet" href="/styles.css" />
    <link rel="icon" href="/logo.png" type="image/png" />
  </head>
  <body>
    <div class="shell" id="shell">
      <header class="topbar">
        <div class="toolbar-row" id="toolbarRow">
          <div class="shell-title shell-title-main">
            <div class="panel-title">
              ZLOG <span class="toolbar-tagline">(NDJSON stream viewer)</span>
            </div>
          </div>
          <div class="toggles">
            <button
              id="toggleAuto"
              class="toggle-btn"
              type="button"
              aria-pressed="true"
              data-state="on"
            >
              <svg class="toggle-icon" viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M11,6V14L7.5,10.5L6.08,11.92L12,17.84L17.92,11.92L16.5,10.5L13,14V6H11M12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22Z"
                />
              </svg>
              <span>Auto-scroll</span>
            </button>
            <button
              id="toggleWrap"
              class="toggle-btn"
              type="button"
              aria-pressed="false"
              data-state="off"
            >
              <svg class="toggle-icon" viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M7,21H5V3H7V21M19,3H17V21H19V3M13,8H9V10H12.97C13.14,10 14,10.16 14,12C14,13.84 13.14,14 13,14H11V12L8,15L11,18V16H13C14.04,16 16,15.16 16,12C16,8.84 14.04,8 13,8Z"
                />
              </svg>
              <span>Wrap lines</span>
            </button>
            <button
              id="toggleAlt"
              class="toggle-btn"
              type="button"
              aria-pressed="false"
              data-state="off"
            >
              <svg class="toggle-icon" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M3 5H21V9H3V5M3 10H21V14H3V10M3 15H21V19H3V15Z" />
              </svg>
              <span>Alternate rows</span>
            </button>
            <button
              id="togglePlain"
              class="toggle-btn"
              type="button"
              aria-pressed="true"
              data-state="on"
            >
              <svg class="toggle-icon" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M4,9H20V11H4V9M4,13H14V15H4V13Z" />
              </svg>
              <span>Show plain</span>
            </button>
            <button
              id="toggleChannel"
              class="toggle-btn"
              type="button"
              aria-pressed="false"
              data-state="off"
            >
              <svg class="toggle-icon" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M16,5V18H21V5M4,18H9V5H4M10,18H15V5H10V18Z" />
              </svg>
              <span>Show channel column</span>
            </button>
            <button
              id="toggleDark"
              class="toggle-btn"
              type="button"
              aria-pressed="false"
              data-state="off"
            >
              <svg class="toggle-icon" viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M17.75,4.09L15.22,6.03L16.13,9.09L13.5,7.28L10.87,9.09L11.78,6.03L9.25,4.09L12.44,4L13.5,1L14.56,4L17.75,4.09M21.25,11L19.61,12.25L20.2,14.23L18.5,13.06L16.8,14.23L17.39,12.25L15.75,11L17.81,10.95L18.5,9L19.19,10.95L21.25,11M18.97,15.95C19.8,15.87 20.69,17.05 20.16,17.8C19.84,18.25 19.5,18.67 19.08,19.07C15.17,23 8.84,23 4.94,19.07C1.03,15.17 1.03,8.83 4.94,4.93C5.34,4.53 5.76,4.17 6.21,3.85C6.96,3.32 8.14,4.21 8.06,5.04C7.79,7.9 8.75,10.87 10.95,13.06C13.14,15.26 16.1,16.22 18.97,15.95M17.33,17.97C14.5,17.81 11.7,16.64 9.53,14.5C7.36,12.31 6.2,9.5 6.04,6.68C3.23,9.82 3.34,14.64 6.35,17.66C9.37,20.67 14.19,20.78 17.33,17.97Z"
                />
              </svg>
              <span>Dark mode</span>
            </button>
          </div>
          <div class="toolbar">
            <div class="control">
              <label class="field-label" for="levelMinRange">Level range</label>
              <div class="range-slider" id="levelRange">
                <div class="range-track">
                  <div class="range-fill" id="levelRangeFill"></div>
                </div>
                <input
                  id="levelMinRange"
                  class="range-input range-min"
                  type="range"
                  min="0"
                  max="5"
                  step="1"
                  value="0"
                  aria-label="Minimum level"
                />
                <input
                  id="levelMaxRange"
                  class="range-input range-max"
                  type="range"
                  min="0"
                  max="5"
                  step="1"
                  value="5"
                  aria-label="Maximum level"
                />
                <div class="range-label range-label-min" id="levelMinLabel">Trace</div>
                <div class="range-label range-label-max" id="levelMaxLabel">Fatal</div>
              </div>
            </div>
            <div class="control">
              <label class="field-label">Channel</label>
              <div class="button-group" id="channelButtons" role="group" aria-label="Channel filters"></div>
            </div>
            <div class="control">
              <label class="field-label">Filter</label>
              <div class="log-filters" id="logFilters">
                <div class="filter-tag filter-input-tag" id="filterInputTag">
                  <input
                    id="filterInput"
                    class="filter-input"
                    type="text"
                    placeholder="Add a filter"
                    autocomplete="off"
                    aria-label="Filter"
                  />
                  <span class="filter-help" aria-label="Filter syntax help">
                    ?
                    <span class="filter-help-tooltip" role="tooltip">
                      <span class="filter-help-title">Examples</span>
                      <span class="filter-help-row"><code>abc</code> (search in message)</span>
                      <span class="filter-help-row"><code>/^aws/i</code> (regex)</span>
                      <span class="filter-help-row"><code>.hostname == "myhost"</code></span>
                      <span class="filter-help-row"><code>.channel = "api"</code> (alias for ==)</span>
                      <span class="filter-help-row"><code>.session</code> (field exists)</span>
                      <span class="filter-help-row"><code>.duration >= 120</code></span>
                      <span class="filter-help-row"><code>.term contains "list"</code></span>
                      <span class="filter-help-row"><code>.tags[0] == "api"</code></span>
                    </span>
                  </span>
                </div>
              </div>
            </div>
            <div class="control">
              <label class="field-label">Map</label>
              <div class="map-input-tag" id="mapInputTag">
                <input
                  id="mapInput"
                  class="filter-input"
                  type="text"
                  placeholder=".msg"
                  autocomplete="off"
                  aria-label="Map expression"
                />
                <span class="filter-help" aria-label="Map syntax help">
                  ?
                  <span class="filter-help-tooltip" role="tooltip">
                    <span class="filter-help-title">Examples</span>
                    <span class="filter-help-row"><code>.msg</code> (default message)</span>
                    <span class="filter-help-row"><code>.user.name</code></span>
                    <span class="filter-help-row"><code>.status, .duration</code> (multiple columns)</span>
                    <span class="filter-help-row"><code>."event.type"</code></span>
                  </span>
                </span>
              </div>
            </div>
          </div>
          <div class="toolbar-spacer" aria-hidden="true"></div>
          <div class="actions">
            <button
              id="toolbarCollapseBtn"
              class="toggle-btn toolbar-collapse-btn"
              type="button"
              aria-pressed="true"
              data-state="on"
              aria-label="Toggle toolbar"
            >
              <svg class="toggle-icon" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M7,10L12,15L17,10H7Z" />
              </svg>
              <span>Toolbar</span>
            </button>
            <button id="pauseBtn" class="toggle-btn" type="button" aria-pressed="false" data-state="off">
              <svg class="toggle-icon" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M14,19H18V5H14M6,19H10V5H6V19Z" />
              </svg>
              <span>Pause</span>
            </button>
            <button id="exportBtn" class="toggle-btn" type="button">
              <svg class="toggle-icon" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M12,19L8,15H10.5V12H13.5V15H16L12,19Z" />
              </svg>
              <span>Export</span>
            </button>
            <button id="copyBtn" class="toggle-btn" type="button">
              <svg class="toggle-icon" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" />
              </svg>
              <span>Copy</span>
            </button>
            <button id="clearBtn" class="toggle-btn" type="button">
              <svg class="toggle-icon" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" />
              </svg>
              <span>Clear</span>
            </button>
          </div>
        </div>
      </header>

      <main class="layout">
        <section class="log-panel" id="logPanel">
          <div class="panel-header">
            <div class="panel-title">Logs</div>
          </div>
          <div class="log-list" id="logList"></div>
          <div class="resize-placeholder" role="status" aria-live="polite">
            Resizingâ€”rendering paused until layout stabilizes.
          </div>
          <button
            id="scrollBottomBtn"
            class="scroll-bottom-btn"
            type="button"
            aria-hidden="true"
            tabindex="-1"
          >
            Scroll to bottom
          </button>
        </section>

        <aside class="detail-panel empty">
          <div class="panel-header">
            <div class="panel-title">Details</div>
            <button id="closeBtn" class="link-button">Close</button>
          </div>
          <div class="detail-grid" id="detailGrid">
            <div class="detail-empty" id="detailEmpty">
              Select a log line to inspect fields.
            </div>
            <div class="detail-card detail-raw" id="detailRawCard">
              <div class="detail-card-title-row">
                <div class="detail-card-title">Raw</div>
                <button id="copyRawBtn" class="btn ghost small">COPY</button>
              </div>
              <pre class="detail-raw-body" id="detailRaw"></pre>
            </div>
            <div class="detail-card" id="detailSummaryCard">
              <div class="detail-card-title">Summary</div>
              <div class="detail-table">
                <div class="detail-row">
                  <div class="detail-key">Level</div>
                  <div class="detail-value" id="detailLevel">-</div>
                </div>
                <div class="detail-row">
                  <div class="detail-key">Time</div>
                  <div class="detail-value" id="detailTime">-</div>
                </div>
                <div class="detail-row">
                  <div class="detail-key">Ingested</div>
                  <div class="detail-value" id="detailIngested">-</div>
                </div>
            <div class="detail-row">
              <div class="detail-key">Channel</div>
              <div class="detail-value" id="detailChannel">-</div>
            </div>
            <div class="detail-row">
              <div class="detail-key">PID</div>
              <div class="detail-value" id="detailPid">-</div>
            </div>
            <div class="detail-row">
              <div class="detail-key">Hostname</div>
              <div class="detail-value" id="detailHostname">-</div>
            </div>
            <div class="detail-row">
              <div class="detail-key">Message</div>
              <div class="detail-value" id="detailMessage">-</div>
            </div>
                <div class="detail-row">
                  <div class="detail-key">Parse Error</div>
                  <div class="detail-value" id="detailParseError">-</div>
                </div>
              </div>
            </div>
            <div class="detail-card" id="detailFieldsCard">
              <div class="detail-card-title">Extra fields</div>
              <div class="detail-table" id="detailFields"></div>
            </div>
          </div>
        </aside>
      </main>

      <footer class="status-bar">
        <div class="shortcuts">
          <span class="shortcut-group">
            <span class="shortcut-label">Move</span>
            <kbd class="kbd">J</kbd>
            <kbd class="kbd">K</kbd>
            <kbd class="kbd">Up</kbd>
            <kbd class="kbd">Down</kbd>
          </span>
          <span class="shortcut-sep">|</span>
          <span class="shortcut-group">
            <span class="shortcut-label">Page</span>
            <kbd class="kbd">U</kbd>
            <kbd class="kbd">D</kbd>
          </span>
          <span class="shortcut-sep">|</span>
          <span class="shortcut-group">
            <span class="shortcut-label">Bottom</span>
            <kbd class="kbd">Space</kbd>
          </span>
          <span class="shortcut-sep">|</span>
          <span class="shortcut-group">
            <span class="shortcut-label">Deselect</span>
            <kbd class="kbd">ESC</kbd>
          </span>
        </div>
        <span class="status-spacer" aria-hidden="true"></span>
        <div class="status-right">
          <div class="panel-meta">
            <span id="countTotal">0</span> total
            <span class="sep">|</span>
            <span id="countFiltered">0</span> visible
            <span class="sep">|</span>
            <span id="newCount">0</span> new
            <span class="sep" id="selectedSep" style="display: none;">|</span>
            <span id="selectedCount" style="display: none;"><span id="countSelected">0</span> selected</span>
          </div>
          <div class="status-line">
            <span class="status-item" id="statusText">
              <svg class="status-dot" viewBox="0 0 10 10" aria-hidden="true" focusable="false">
                <circle cx="5" cy="5" r="5" />
              </svg>
              <span id="statusTextLabel">connecting</span>
            </span>
          </div>
        </div>
      </footer>
    </div>

    <script src="/app.js"></script>
  </body>
</html>
